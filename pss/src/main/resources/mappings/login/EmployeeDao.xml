<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nmw.pss.module.login.dao.EmployeeDao">
    <resultMap type="Employee" id="entityResult">
    	<id property="id" column="id"/>
    	<result property="createTime" column="create_time"/>
    	<result property="updateTime" column="update_time"/>
    	<result property="createUserId" column="create_user"/>
    	<result property="updateUserId" column="update_user"/>
    	<result property="remark" column="remark"/>
    	<result property="delSign" column="del_sign"/>
    	
    	<result property="jobNo" column="job_no"/>
    	<result property="loginName" column="login_name"/>
    	<result property="loginPass" column="login_pass"/>
    	<result property="nickName" column="nick_name"/>
    	<result property="headPic" column="head_pic"/>
    	<result property="email" column="email"/>
    	<result property="phone" column="phone"/>
    	<result property="tel" column="tel"/>
    	<result property="status" column="status"/>
    	<result property="entryTime" column="entry_time"/>
    	<result property="quitTime" column="quit_time"/>
    	<result property="birthday" column="birthday"/>
    	<result property="idCardNo" column="idcard_no"/>
    </resultMap>
    
	<insert id="insert">
		INSERT INTO employee(id, create_time, update_time, create_user, update_user, remark, del_sign,
			job_no, login_name, login_pass, nick_name, head_pic, email, phone, tel, status, entry_time, quit_time, birthday, idcard_no) 
		VALUES (#{id}, #{createTime}, #{updateTime}, #{createUserId}, #{updateUserId}, #{remark}, #{delSign}, 
		#{jobNo}, #{loginName}, #{loginPass}, #{nickName}, #{headPic}, #{email}, #{phone}, #{tel}, #{status}, #{entryTime}, #{quitTime}, #{birthday}, #{idCardNo})
	</insert>
	
	<delete id="deleteById">
		DELETE FROM employee WHERE id = #{id}
	</delete>
	
	<select id="selectById" resultMap="entityResult">
		SELECT 
			*
		FROM 
			employee 
		WHERE 
			id = #{id}
	</select>
	
	<update id="updateById">
		UPDATE employee 
		SET 
			update_time = #{updateTime}, 
			update_user = #{updateUserId}, 
			remark = #{remark}, 
			del_sign = #{delSign}, 
			
			login_pass = #{loginPass}, 
			nick_name = #{nickName}, 
			head_pic = #{headPic}, 
			email = #{email}, 
			phone = #{phone},
			tel = #{tel},
			status = #{status},
			entry_time = #{entryTime},
			quit_time = #{quitTime},
			birthday = #{birthday},
			idcard_no = #{idCardNo}
		WHERE id = #{id}
	</update>
	
	<select id="selectByModel" resultMap="entityResult">
		SELECT 
			*
		FROM 
			employee 
		<where>
			del_sign=#{DEL_NORMAL}
			<if test="jobNo != null and jobNo != ''">
				AND job_no=#{jobNo}
			</if>
			<if test="loginName != null and loginName != ''">
				AND login_name=#{loginName}
			</if>
			<if test="phone != null and phone != ''">
				AND phone=#{phone}
			</if>
			<if test="status != null and status != ''">
				AND status=#{status}
			</if>
		</where>
	</select>
	
	<select id="selectByPage" parameterType="Page" resultMap="entityResult">
		SELECT 
			e.id as id,
			e.create_time as createTime,
			e.update_time as updateTime,
			e.create_user as createUserId,
			e.update_user as updateUserId,
			e.remark as remark,
			e.del_sign as delSign,
			
			e.job_no as jobNo,
			e.login_name as loginName,
			e.login_pass as loginPass,
			e.nick_name as nickName,
			e.head_pic as headPic,
			e.email as email,
			e.phone as phone,
			e.tel as tel,
			e.status as status,
			e.entry_time as entryTime,
			e.quit_time as quitTime,
			e.birthday as birthday,
			e.idcard_no as idCardNo
		FROM 
			(SELECT * FROM employee WHERE id=#{queryObj.id}) as temp RIGHT JOIN employee e ON temp.id=e.id
		<where>
			e.del_sign=#{queryObj.DEL_NORMAL}
			<if test="queryObj.jobNo != null and queryObj.jobNo != ''">
				AND e.job_no=#{queryObj.jobNo}
			</if>
			<if test="queryObj.loginName != null and queryObj.loginName != ''">
				AND e.login_name=#{queryObj.loginName}
			</if>
			<if test="queryObj.phone != null and queryObj.phone != ''">
				AND e.phone=#{queryObj.phone}
			</if>
			<if test="queryObj.status != null and queryObj.status != ''">
				AND e.status=#{queryObj.status}
			</if>
		</where>
	</select>
</mapper>